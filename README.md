# Instar_Filter

### 프로젝트 명: 인스타그램_필터_GUI

### 1. 기간: 2024.09 ~ 2024. 09

### 2. 기술 스택
- **Python** : 프로그래밍 언어
- **tkinter** : GUI 개발
- **Pytorch** : 딥러닝 모델 로드
- **Halb_fast_neural_style** : 스타일 변환을 위한 라이브러리
- **PIL(Pillow)** : 이미지 처리

## 3. 주요기능: 
- **이미지 업로드 및 전처리**: 사용자가 지정한 이미지를 1:1 비율로 크롭, 리사이즈하여 준비
- **스타일 변환**: 여러 가지 스타일(예: Paprika, Mosaic, Candy)로 이미지를 변환.
- **실시간 미리보기**: 사용자는 각 스타일에 대해 변환된 이미지를 즉시 확인.
- **GUI 구성**: 직관적인 버튼과 레이블을 사용하여 사용자가 쉽게 조작할 수 있도록 구성.

## 4. 프로젝트 설명
  - 이 프로젝트는 사용자가 이미지를 다양한 예술 스타일로 변환할 수 있는 GUI 애플리케이션
  - 사용자는 입력 이미지를 선택하고, 다양한 사전 학습된 Neural Style Transfer 모델을 통해 변환된 이미지를 미리 볼 수 있음.
  - `tkinter`를 이용하여 직관적인 사용자 인터페이스를 제공하며, 사용자는 클릭 한 번으로 원하는 스타일의 이미지를 확인할 수 있음.

## 5.내용
- 이미지 처리 함수 구현
  - 함수: `read_square_image` 이 함수는 이미지 파일을 읽고, 중앙을 기준으로 1:1 비율로 자른 후, 원하는 크기로 리사이즈하는 기능을 수행.
  - **기능 개요**:
    - 입력된 이미지 파일을 RGB 형식으로 변환한 뒤, 가로와 세로 크기를 비교하여 중앙을 기준으로 자르고, 최종적으로 사용자가 지정한 크기로 이미지를 리사이즈.
  - **세부 기능**:
    - **이미지 로딩 및 변환**: `PIL.Image` 라이브러리를 사용하여 이미지를 읽고 RGB로 변환.
    - **이미지 크롭**: 가로와 세로의 크기를 비교한 후, 긴 방향을 기준으로 잘라내 1:1 비율 맞춤.
    - **이미지 리사이즈**: 잘라낸 이미지를 LANCZOS 필터를 사용하여 고품질로 리사이즈.
  - **적용 예시**:프로필 사진을 1:1 비율로 맞춘 후 소셜 미디어에 업로드하거나, 이미지 갤러리에서 동일한 크기의 썸네일을 만들 때 유용.
- GUI 구현
  - Python의 tkinter 라이브러리를 사용하여 간단한 GUI 창을 만들고, 이미지를 다양한 위젯에 표시하는 기능을 구현.
  - **기능 개요**:
    - 이미지 파일을 불러와서 Tkinter 창에 표시하는 작업을 수행합니다. 이 이미지는 `Canvas`, `Label`, `Button` 위젯에 동일하게 표시.
  - **세부 기능**:
    - **이미지 로딩**: PIL 라이브러리의 `ImageTk.PhotoImage` 클래스를 사용하여 이미지를 Tkinter에서 사용할 수 있도록 변환.
    - **Canvas 위젯에 이미지 추가**: `Canvas`는 사용자가 그래픽을 그리거나 이미지를 배치할 수 있는 위젯입니다. 이 예제에서는 중앙에 이미지를 배치.
    - **Label 위젯에 이미지 추가**: `Label`은 텍스트 또는 이미지를 표시할 수 있는 위젯으로, 이미지를 손쉽게 표시할 수 있음.
    - **Button 위젯에 이미지 추가**: `Button` 위젯에 이미지를 삽입하여 이미지 버튼을 구현.
  - **주요 특징**:
    - 각 위젯에서 이미지를 표시할 뿐만 아니라, 동적으로 이미지를 변경할 수 있는 확장 가능성을 보여줌.
    - 간단한 GUI 창에서 이미지를 여러 방식으로 표시하는 방법을 배울 수 있는 예제.
  - **적용 예시**: 이미지 뷰어 프로그램이나, GUI 기반의 이미지 편집 도구에서 유용하게 활용될 수 있음.
  - ![image](https://github.com/user-attachments/assets/4805b02f-e861-4cf0-af11-547db7b653e5)

- GUI_2 구현
  - `tkinter` 라이브러리를 활용하여 GUI에서 프레임 구조를 사용하여 위젯들을 깔끔하게 배치하는 예제. 각 프레임에는 이미지와 텍스트가 결합된 버튼과 라벨을 배치하여, 동일한 이미지를 다양한 방식으로 프레임에 표시.
  - **기능 개요**:
    - `Frame`을 사용해 창 내부에 섹션을 나누고, 각각의 프레임에 텍스트와 이미지를 배치하여 다양한 GUI 요소를 구조적으로 관리할 수 있는 방법을 보여줌.
  - **세부 기능**:
    - **프레임 구조**: `Frame` 위젯을 이용하여 창을 여러 섹션으로 나누고, 각 프레임에 위젯을 배치합니다. 이로 인해 UI가 더 체계적으로 관리.
    - **Label과 Button 배치**: 각 프레임에 텍스트를 표시하는 `Label`과 이미지를 표시하는 `Button`을 각각 배치하여, 사용자가 프레임 내에서 다양한 인터페이스 요소를 동시에 사용할 수 있음.
    - **이미지 표시**: `Button` 위젯에 이미지를 표시하여 GUI 요소에 이미지를 활용하는 방법을 시연. `PIL` 라이브러리를 사용하여 이미지를 불러오고 `ImageTk.PhotoImage`로 변환하여 Tkinter와 연동.
  - **주요 특징**:
    - GUI 창을 프레임을 통해 논리적으로 나누어, 각 섹션에 위젯을 배치할 수 있는 구조적 관리 방법을 제공.
    - 이미지를 GUI의 여러 요소에 쉽게 적용할 수 있는 방법을 보여줌.
    - 텍스트와 이미지를 결합한 버튼 및 레이블의 배치 가능성 시연.
  - **적용 예시**: 프레임 단위로 UI 요소를 구성하여, 복잡한 GUI 레이아웃을 체계적으로 관리할 때 유용. 이미지 기반 애플리케이션이나 설정 패널이 있는 프로그램에서 활용될 수 있음.
  - ![image](https://github.com/user-attachments/assets/5d1584da-a716-4d82-965e-a5112424c9c5)

- 이미지 카툰화 변환 모델(cartoonify)
  - `AnimeGAN2`라는 사전 학습된 모델을 사용하여 이미지를 애니메이션 스타일로 변환하는 기능을 수행합니다. `torch` 라이브러리의 `hub`를 통해 모델을 불러오고, 주어진 이미지를 카툰 스타일로 변환합니다.
  - **기능 개요**:
    - 주어진 이미지를 AnimeGAN2 모델을 사용해 애니메이션 스타일로 변환하는 작업을 수행합니다. 특히, 얼굴 이미지를 카툰화하여 애니메이션 캐릭터처럼 보이게 만듭니다.
  - **세부 기능**:
    - **이미지 준비**: 이미지 크롭 및 리사이즈 작업을 거쳐, 1:1 비율로 조정된 이미지를 준비합니다. (이전 `read_square_image` 함수를 재사용)
    - **AnimeGAN2 모델 불러오기**: `torch.hub`를 사용해 `bryandlee/animegan2-pytorch`에서 사전 학습된 카툰화 모델과, 얼굴 변환 함수인 `face2paint`를 불러옵니다.
        - `generator`: 주어진 프레임을 애니메이션 스타일로 변환하는 모델.
        - `face2paint`: 이미지를 카툰화하는 변환 함수로, 얼굴을 중심으로 작동합니다.
    3. **카툰화 적용**: `face2paint` 함수에 모델과 이미지를 전달해 이미지를 애니메이션 스타일로 변환합니다.
  - **주요 특징**:
    - 사전 학습된 AnimeGAN2 모델을 사용해 이미지의 스타일을 애니메이션화할 수 있으며, 실제 인물의 얼굴을 애니메이션처럼 변환하는 데 최적화된 기능을 제공합니다.
    - 모델은 다양한 학습 데이터를 기반으로 사전 학습되어 있으며, 애니메이션 스타일 변환에 필요한 복잡한 과정을 단순화시킵니다.
    - `pretrained` 인자로 다양한 스타일을 선택할 수 있으며, 여기서는 'paprika' 스타일이 적용되었습니다.
  - **적용 예시**: 얼굴 이미지나 프로필 사진을 애니메이션 스타일로 변환하여 다양한 창작 작업에 활용할 수 있습니다. 예를 들어, 만화 캐릭터로 사용자 이미지를 변환하는 웹 애플리케이션이나, 이미지 기반의 필터 앱 개발에 유용하게 사용될 수 있음.
  - ![image](https://github.com/user-attachments/assets/b98ff032-c613-4618-8754-4f8f7ae6612c)


- 이미지 스타일 변환(Neural Style Transfer)
  - `hlab_fast_neural_style` 라이브러리를 사용하여 이미지에 새로운 스타일을 적용하는 작업을 수행. Neural Style Transfer 기법을 활용하여 주어진 이미지를 특정 예술 스타일로 변환.
  - **기능 개요**:
    - Neural Style Transfer 모델을 사용하여 입력된 이미지를 선택한 예술 스타일로 변환. 이 경우, 'Candy'라는 스타일을 적용하여 이미지의 시각적 효과를 바꿈.
  - **세부 기능**:
    - **이미지 준비**: `read_square_image` 함수를 사용하여 입력 이미지를 256x256 크기로 크롭 및 리사이즈.
    - **스타일 변환 모델 적용**: `hlab_fast_neural_style` 라이브러리의 `stylize` 함수를 사용해 Neural Style Transfer 모델을 불러옴. 여기서 모델은 `saved_models/candy.pth`로 지정된 사전 학습된 'Candy' 스타일을 사용.
    - **스타일 변환**: 입력 이미지에 'Candy' 스타일을 적용해 이미지를 변환합니다. 이 작업은 원본 이미지의 주요 구조를 유지하면서, 예술적 효과를 덧입혀 시각적으로 완전히 다른 결과를 얻는 과정을 포함.
  - **주요 특징**:
    - **Neural Style Transfer**: CNN 기반의 신경망을 통해 이미지의 스타일을 변환하는 기법으로, 입력 이미지의 콘텐츠는 유지하면서 다른 스타일을 적용할 수 있음.
    - **사전 학습된 모델**: 다양한 예술 스타일을 사전 학습한 모델들을 사용하여 손쉽게 이미지를 변환할 수 있음. 이 예제에서는 'Candy' 스타일을 적용하였으나, 다른 스타일도 적용 가능.
    - **실시간 스타일링**: 효율적으로 설계된 스타일 변환 알고리즘을 통해 빠르게 이미지를 변환할 수 있음.
  - **적용 예시**: 이미지에 다양한 예술적 스타일을 입히는 작업에 적합. 예를 들어, 사진을 예술작품처럼 변환하는 필터 앱이나, 사용자 사진을 독창적인 스타일로 변환하는 웹 애플리케이션에 적용할 수 있음.
  - ![image](https://github.com/user-attachments/assets/cfe9a018-963f-4956-b8e7-8fe315001d45)

- 이미지 모자이크 스타일 변환(Neural Style Transfer)
  - Neural Style Transfer를 사용하여 입력 이미지를 'Mosaic' 스타일로 변환하는 작업을 수행. `hlab_fast_neural_style` 라이브러리를 활용하여, 원본 이미지를 예술적인 모자이크 스타일로 재구성.
  - **기능 개요**:
    - Neural Style Transfer 기술을 사용해 원본 이미지를 모자이크 예술 스타일로 변환. 사전 학습된 스타일 변환 모델을 사용하여 빠르게 이미지를 스타일화.
  - **세부 기능**:
    - **이미지 준비**: `read_square_image` 함수로 이미지를 256x256 픽셀 크기로 크롭하고 리사이즈하여 준비.
    - **모자이크 스타일 적용**: `hlab_fast_neural_style` 라이브러리의 `stylize` 함수를 사용해, 사전 학습된 모자이크 스타일 모델(`saved_models/mosaic.pth`)을 불러와 이미지에 적용.
    - **스타일 변환**: 이 과정에서 원본 이미지의 주요 내용은 유지되지만, 색상 및 질감은 모자이크 아트의 특성을 반영해 새롭게 재구성.
  - **주요 특징**:
    - **Neural Style Transfer**: 콘텐츠 이미지를 보존하면서도 예술적이고 독특한 스타일을 적용하는 기법으로, CNN 모델을 활용한 이미지 변환을 실시간으로 적용할 수 있음.
    - **모자이크 스타일**: 모자이크는 작은 타일 조각들이 모여 전체적인 그림을 구성하는 예술 형태로, 이미지에 모자이크 텍스처와 색감을 부여하여 독특한 시각 효과를 제공.
    - **사전 학습된 모델**: `saved_models/mosaic.pth` 모델은 미리 학습된 모자이크 스타일 변환 모델로, 이미지를 빠르고 효율적으로 변환.
  - **적용 예시**: 사진을 모자이크 스타일로 변환하여, 독특한 예술 작품처럼 보이게 만들 수 있음. 예술 프로젝트나 사진을 독특하게 변형해야 하는 다양한 창작 애플리케이션에서 유용하게 사용될 수 있음.
  - ![image](https://github.com/user-attachments/assets/8b948293-fbec-4743-9416-9b372b107244)


- 이미지 'Rain Princess' 스타일 변환(Neural style Transfer)
  - Neural Style Transfer를 사용하여 입력 이미지를 사전 학습된 'Rain Princess' 스타일로 변환하는 기능을 구현. `hlab_fast_neural_style` 라이브러리를 통해 원본 이미지를 독창적인 예술 스타일로 재해석.
  - **기능 개요**:
    - Neural Style Transfer 기술을 활용하여 입력된 이미지를 'Rain Princess'라는 예술적인 스타일로 변환. 이 스타일은 Vincent van Gogh의 작품과 유사한 표현을 가지며, 강렬한 붓터치와 생생한 색감이 특징.
  - **세부 기능**:
    - **이미지 준비**: `read_square_image` 함수를 사용하여 이미지를 256x256 크기로 크롭 및 리사이즈.
    - **스타일 변환 적용**: `hlab_fast_neural_style` 라이브러리의 `stylize` 함수를 사용하여 'Rain Princess'라는 사전 학습된 스타일 변환 모델(`saved_models/rain_princess.pth`)을 불러와 이미지를 변환.
    - **스타일 변환**: 원본 이미지의 구조적 요소는 그대로 유지하되, 색상 및 텍스처는 'Rain Princess' 스타일의 독창적인 특징을 반영하여 새로운 예술적 이미지로 재구성.
  - **주요 특징**:
    - **Neural Style Transfer**: CNN을 사용한 신경망 기술로, 이미지의 콘텐츠는 보존하면서도 다른 예술적 스타일을 적용하는 방식('Rain Princess'라는 고유한 스타일을 사용).
    - **'Rain Princess' 스타일**: 'Rain Princess' 스타일은 Van Gogh의 작품처럼 강렬한 색상 대비와 강한 붓터치가 특징으로, 이미지에 독창적인 예술적 감각을 부여.
    - **사전 학습된 모델**: `saved_models/rain_princess.pth`는 사전 학습된 Neural Style Transfer 모델로, 이미지를 빠르게 변환할 수 있도록 최적화.
  - **적용 예시**: 사용자 사진이나 예술 프로젝트에 예술적인 스타일을 적용하고자 할 때 유용. 예를 들어, 사진을 독특한 회화 스타일로 변환하여 개인화된 작품을 생성하거나, 창작 애플리케이션에서 이미지 필터로 사용할 수 있음
  - ![image](https://github.com/user-attachments/assets/cac06365-5379-49dc-8f8a-e0e8dd5a9823)

- 이미지 'Udnie' 스타일 변환(Neural Style Transfer)
  - Neural Style Transfer를 사용해 입력 이미지를 'Udnie'라는 예술적 스타일로 변환. `hlab_fast_neural_style` 라이브러리를 활용하여 이미지를 빠르게 스타일화하며, 원본 이미지에 예술적 감각을 더함.
  - **기능 개요**:
    - Neural Style Transfer를 사용하여 이미지를 사전 학습된 'Udnie' 스타일로 변환하는 작업을 수행.
    - 'Udnie'는 추상화된 강렬한 예술 표현이 특징인 스타일로, 원본 이미지에 독특한 색감과 텍스처 변화를 적용.
  - **세부 기능**:
    - **이미지 준비**: `read_square_image` 함수로 이미지의 크기를 256x256으로 조정.
    - **'Udnie' 스타일 적용**: `hlab_fast_neural_style` 라이브러리의 `stylize` 함수를 사용하여 'Udnie' 스타일을 적용합니다. 모델 파일 경로는 `saved_models/udnie.pth`로 지정되어 있으며, 이 모델은 사전 학습된 Neural Style Transfer 모델.
    - **스타일 변환**: Neural Style Transfer를 통해 이미지의 콘텐츠를 유지하면서, 스타일 특유의 추상적이고 과감한 붓터치와 색상 변화가 이미지에 적용.
  - **주요 특징**:
    - **Neural Style Transfer**: 신경망 기반의 이미지 변환 기술로, 입력된 이미지의 주요 내용을 유지하면서도 특정 예술 스타일을 덧입힘.
    - **'Udnie' 스타일**: 'Udnie' 스타일은 추상 미술에서 영감을 받은 강렬한 붓터치와 과감한 색상 변화가 특징으로, 이미지에 독창적인 미학을 더함.
    - **사전 학습된 모델**: `saved_models/udnie.pth`는 이 스타일에 최적화된 사전 학습 모델로, 이미지를 빠르게 스타일화하여 결과물을 생성.
  - **적용 예시**: 사진을 독창적이고 예술적인 작품으로 변환하고자 할 때 유용. 예를 들어, 사진을 추상화된 스타일로 변형하여 창작 프로젝트나 미적 표현이 필요한 다양한 애플리케이션에서 활용할 수 있음.
  - ![image](https://github.com/user-attachments/assets/551afd0b-f876-4e86-8bb2-ed725fcecfc4)

## 6.실행화면
- 여러 스타일 버튼(Normal, Paprika, mosaic, candy) 표시
- 각 스타일 버튼을 클릭하면, 해당 스타일로 변환된 이미지가 표시
- 변환된 이미지를 확인하고, 필요에 따라 저장할 수 있음
![인스타필터](https://github.com/user-attachments/assets/e9350718-6ccc-4d52-ab86-98c891f490e5)

## 7.결론
- 이 프로젝트는 이미지 스타일 변환 기술을 활용하여 사용자가 손쉽게 예술적 이미지를 생성할 수 있도록 설계 되어있음
- 다양한 스타일을 지원하고 직관적인 사용자 인터페이스를 제공함으로써, 창의적인 작업에 필요한 도구를 갖추게 됨.

## 8. Reference:
